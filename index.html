<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Solana NFT Mint | Devnet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Solana & Metaplex -->
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
  <script src="https://unpkg.com/@metaplex-foundation/js@latest/dist/index.umd.js"></script>

  <style>
    body {
      margin: 0;
      background: #0b0b0b;
      font-family: Arial, sans-serif;
      color: #ffffff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .box {
      background: #151515;
      padding: 30px;
      border-radius: 12px;
      text-align: center;
      width: 90%;
      max-width: 420px;
    }

    h1 {
      margin-bottom: 20px;
    }

    button {
      width: 100%;
      padding: 14px;
      margin-top: 10px;
      border-radius: 8px;
      border: none;
      font-size: 16px;
      cursor: pointer;
      background: #7c3aed;
      color: white;
    }

    button:disabled {
      background: #555;
      cursor: not-allowed;
    }

    p {
      margin-top: 12px;
      word-break: break-all;
    }
  </style>
</head>

<body>

<div class="box">
  <h1>üöÄ NFT Mint (Devnet)</h1>

  <button id="connectWallet">üîå Connect Wallet</button>
  <p id="wallet"></p>

  <button id="mintBtn" disabled>üé® Mint NFT</button>

  <p id="status"></p>
</div>

<script>
  const { Connection, clusterApiUrl, PublicKey } = solanaWeb3;
  const { Metaplex, walletAdapterIdentity } = metaplex;

  // üîë DEVNET Candy Machine ID
  const CANDY_MACHINE_ID = new PublicKey(
    "6Eqhz5ZC1ENXTfBDgkSEyyC6DTASvXz8DR7iNRQwxf8N"
  );

  // üåê DEVNET connection
  const connection = new Connection(clusterApiUrl("devnet"), "confirmed");

  let wallet = null;
  let metaplex = null;

  const connectBtn = document.getElementById("connectWallet");
  const mintBtn = document.getElementById("mintBtn");
  const walletText = document.getElementById("wallet");
  const statusText = document.getElementById("status");

  // üîå Connect Wallet
  connectBtn.onclick = async () => {
    try {
      if (!window.solana) {
        alert("Please install Phantom / Solflare wallet");
        return;
      }

      wallet = window.solana;
      await wallet.connect();

      walletText.innerText =
        "Wallet: " + wallet.publicKey.toString();

      metaplex = Metaplex.make(connection)
        .use(walletAdapterIdentity(wallet));

      mintBtn.disabled = false;
      statusText.innerText = "‚úÖ Wallet connected";
    } catch (err) {
      console.error(err);
      statusText.innerText = "‚ùå Wallet connect failed";
    }
  };

  // üé® Mint NFT
  mintBtn.onclick = async () => {
    try {
      statusText.innerText = "‚è≥ Minting NFT...";

      const candyMachine =
        await metaplex.candyMachines().findByAddress({
          address: CANDY_MACHINE_ID,
        });

      const { nft } =
        await metaplex.candyMachines().mint({
          candyMachine,
        });

      statusText.innerText =
        "‚úÖ Mint Success!\nNFT Address:\n" +
        nft.address.toString();
    } catch (err) {
      console.error(err);
      statusText.innerText =
        "‚ùå Mint failed (Check devnet SOL / guards)";
    }
  };
</script>

</body>
</html>
